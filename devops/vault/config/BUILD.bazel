package(default_visibility=["//visibility:public"])

genrule(
    name = "vault_config",
    srcs = select({
        "//:production": ["prod.hcl.tmpl"],
        "//build:kube-env": ["dev.k8s.hcl.tmpl"],
        "//conditions:default": ["dev.hcl.tmpl"],
    }),
    outs = [
        "config.hcl"
    ],
    cmd = ". $(location //build:bash_env) && envsubst < $< > $@",
    tools = [
        "//build:bash_env"
    ]
)
